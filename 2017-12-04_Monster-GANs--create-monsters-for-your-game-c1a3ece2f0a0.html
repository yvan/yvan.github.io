<!DOCTYPE html><html><head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-175038637-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'UA-175038637-1');
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Monster GANs: create monsters for your game</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Monster GANs: create monsters for your game</h1>
</header>
<section data-field="subtitle" class="p-summary">
How to generate novel monsters for your game or just for fun.
</section>
<section data-field="body" class="e-content">
<section name="bbbc" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8970" id="8970" class="graf graf--h3 graf--leading graf--title">Monster GANs: create monsters for your game</h3><p name="7208" id="7208" class="graf graf--p graf-after--h3">How to generate novel monsters for your game or just for fun.</p><p name="f5c6" id="f5c6" class="graf graf--p graf-after--p">In this blog we are going to generate monsters. To do this we are going to use something called a Generative Adversarial Network (GAN). This is a special type of generative model that can, given some set of inputs, generate totally novel outputs. GANs learn features/traits from the input data and try to produce outputs that will have similar features. In this blog post I’m going to generate monsters you could use in your indie game. This could save you many hours of work. Generated monsters are also a great starting point for further art work.</p><p name="63a1" id="63a1" class="graf graf--p graf-after--p">We will turn random colored noise (64x64 pixels):</p><figure name="04fc" id="04fc" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 64px; max-height: 64px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*sxbXkOrLq3fFy54_LzBKBg.png" data-width="64" data-height="64" src="img/1_sxbXkOrLq3fFy54_LzBKBg.png"></div></figure><p name="17d5" id="17d5" class="graf graf--p graf-after--figure">Into monsters like these (64x64 pixels):</p><figure name="a701" id="a701" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 64px; max-height: 64px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*t_FeBYGbLlqrDTryGyzdBg.png" data-width="64" data-height="64" src="img/1_t_FeBYGbLlqrDTryGyzdBg.png"></div><figcaption class="imageCaption">Dark Spirit</figcaption></figure><figure name="da3b" id="da3b" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 64px; max-height: 64px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*TFSopyWeO33-dpr1iJyDqw.png" data-width="64" data-height="64" src="img/1_TFSopyWeO33-dpr1iJyDqw.png"></div><figcaption class="imageCaption">Angry Fire Monster</figcaption></figure><figure name="0458" id="0458" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 64px; max-height: 64px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*O230rGjvuPdKpz81S-c1OQ.png" data-width="64" data-height="64" src="img/1_O230rGjvuPdKpz81S-c1OQ.png"></div><figcaption class="imageCaption">Floating Eye or Magic Spell</figcaption></figure><figure name="1776" id="1776" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 64px; max-height: 64px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*TKdm6y8O85vNPDfbEycVvw.png" data-width="64" data-height="64" src="img/1_TKdm6y8O85vNPDfbEycVvw.png"></div><figcaption class="imageCaption">Horned Demon</figcaption></figure><figure name="2b09" id="2b09" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 64px; max-height: 64px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*SRBx7wR8q245GpakYVd7Nw.png" data-width="64" data-height="64" src="img/1_SRBx7wR8q245GpakYVd7Nw.png"></div><figcaption class="imageCaption">Crazed Blue Chicken</figcaption></figure><p name="7ff3" id="7ff3" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">We will produce a cool animation at the end so read on!</strong></p><p name="d06e" id="d06e" class="graf graf--p graf-after--p">Here are the steps we’ll take:</p><p name="1e91" id="1e91" class="graf graf--p graf-after--p">1 — Collect and prepare the data.</p><p name="a70d" id="a70d" class="graf graf--p graf-after--p">2 — Create a GAN.</p><p name="413d" id="413d" class="graf graf--p graf-after--p">3 — Train the GAN.</p><p name="6b42" id="6b42" class="graf graf--p graf-after--p">4 — Generate monsters!</p><h4 name="0ce4" id="0ce4" class="graf graf--h4 graf-after--p">1 — Collect and prepare the data</h4><p name="43ec" id="43ec" class="graf graf--p graf-after--h4">We need data that looks like monsters. I started going scrounging up pixel art on pinterest and other places but the problem with most of that is that its not at the same resolution and its not at the same style. While you can deal with both these issues I wanted to keep things simple. Eventually I settled on using some open source pokemon art found on 2 different pokemon community forums. Overall in my dataset there’s 14,774 JPG images of varying sizes. I’m calling this dataset the mgan, ‘monster gan,’ data set.</p><p name="87fb" id="87fb" class="graf graf--p graf-after--p"><a href="https://www.dropbox.com/sh/isslk5zkp9ekqtc/AABTfbuLYRID6NhDvq1Vi7Hha?dl=0" data-href="https://www.dropbox.com/sh/isslk5zkp9ekqtc/AABTfbuLYRID6NhDvq1Vi7Hha?dl=0" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">The prepared mgan dataset.</strong></a></p><h4 name="9b09" id="9b09" class="graf graf--h4 graf-after--p">2 — Setup and GAN Creation</h4><p name="5a69" id="5a69" class="graf graf--p graf-after--h4">Now we’ll start laying down some code. We’re going to use pytorch to create our model and train it. I do not recommend that you run this without a powerful GPU. If you need a GPU check out Floydhub. You can pay by the hour there and it’s pretty affordable. In a GAN our generator model is going to learn how to make monsters by trying to make some, then asking another model ‘does my monster look like a real monster?’ This other model will be called the discriminator. The discriminator will tell the generator how bad its attempt to create a monster was. The generator will then take this information and improve its parameters to hopefully be able to generate better monsters. We repeat this process 100–200 times and eventually get a generator that can create novel monsters.</p><p name="c2fd" id="c2fd" class="graf graf--p graf-after--p">Let’s load some data:</p><figure name="fc81" id="fc81" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/f09ed6c1c6032ca45f47f9f107c8d58c.js"></script></figure><p name="fb87" id="fb87" class="graf graf--p graf-after--figure">This code should output a pokemon, mine looks like this:</p><figure name="1636" id="1636" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 590px; max-height: 580px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 98.3%;"></div><img class="graf-image" data-image-id="1*WtPKYgiOu2wEUa9HCk8S4A.png" data-width="590" data-height="580" src="img/1_WtPKYgiOu2wEUa9HCk8S4A.png"></div></figure><p name="4600" id="4600" class="graf graf--p graf-after--figure">I just wanted to check that we could read and output one image from the mgan dataset. Now we’ll get to the good stuff. The GAN, the stuff that actually generates new monsters:</p><figure name="a183" id="a183" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/68de45837dd6d98ef2b80e7374f613ed.js"></script></figure><p name="fa52" id="fa52" class="graf graf--p graf-after--figure">This looks long but if you read the comments it’s not too bad. Basically it just describes a generator model and a dirciminator model and then creates one of each.</p><h4 name="82d0" id="82d0" class="graf graf--h4 graf-after--p">3 — Training the GAN</h4><figure name="baa4" id="baa4" class="graf graf--figure graf--iframe graf-after--h4"><script src="https://gist.github.com/yvan/f4aad9b89cda6120db914c73f801dd7d.js"></script></figure><p name="94ff" id="94ff" class="graf graf--p graf-after--figure">During training this should output lines like so:</p><figure name="6bc9" id="6bc9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 295px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.1%;"></div><img class="graf-image" data-image-id="1*XYsCVjlP9tHA5PjkTLnadQ.png" data-width="1634" data-height="688" src="img/1_XYsCVjlP9tHA5PjkTLnadQ.png"></div></figure><p name="edf2" id="edf2" class="graf graf--p graf-after--figure">They show the epoch (the training round) and how bad the generator is at generating images, and the discriminator losses, which show how good the discriminator is at its job. These values are not necessarily interpretable. Each line shows an image of 64 sample monsters created by the generator from the <code class="markup--code markup--p-code">fixed_noise</code> value. The quality of this image should be increasingly relatively steadily. Every epoch’s generator is saved with the epoch tacked onto the end so if you see one that generates particularly realistic monsters or a style you prefer you can just use that generator from that epoch.</p><h4 name="873c" id="873c" class="graf graf--h4 graf-after--p">4 — Generating Monsters!</h4><p name="d093" id="d093" class="graf graf--p graf-after--h4">I trained 125 generator epochs and in the end I decided that the generator from epoch 90 was the best one (choosing is more art than science). After generating the monsters you may notice most of the monsters generated look like blobs or, for rick and morty fans, cronenberg monsters. This doesn’t actually matter; we can generate an infinite number of monsters by passsing in new random noise. As long as a few are decent we can just keep generating monsters until we get enough good ones. Let’s generate monsters!</p><figure name="b831" id="b831" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/9aca6ec23340bf6b52ca7a56c3acb006.js"></script></figure><p name="235f" id="235f" class="graf graf--p graf-after--figure">This could output something like this:</p><figure name="c4d2" id="c4d2" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 530px; max-height: 464px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 87.5%;"></div><img class="graf-image" data-image-id="1*N4gHhF0pASC8nFQJ0a2puQ.png" data-width="530" data-height="464" data-is-featured="true" src="img/1_N4gHhF0pASC8nFQJ0a2puQ.png"></div></figure><p name="b209" id="b209" class="graf graf--p graf-after--figure">Most of these just look like blobs but some are cool. These two are my favorite from this batch:</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="cfe3" id="cfe3" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*kBY_IAdJdo3WKULobdaunw.png" data-width="64" data-height="64" src="img/1_kBY_IAdJdo3WKULobdaunw.png"></div></figure><figure name="f12c" id="f12c" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*GTdEYIFSQBBWA_E2S4Z6Tg.png" data-width="64" data-height="64" src="img/1_GTdEYIFSQBBWA_E2S4Z6Tg.png"></div><figcaption class="imageCaption" style="width: 200%; left: -100%;">Cute Seahorse and Shadowy Eye</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="ba7c" id="ba7c" class="graf graf--p graf-after--figure">If you re-run the <code class="markup--code markup--p-code">noise =</code> line you’ll keep getting new monsters. You may notice some similar monsters generated each time. If you keep generating though you should be able to build up a pretty decent collection of unique monsters.</p><h4 name="dd0f" id="dd0f" class="graf graf--h4 graf-after--p">Conclusion and GIF</h4><p name="6d12" id="6d12" class="graf graf--p graf-after--h4"><a href="https://github.com/yvan/nbsblogs/blob/master/generating_monters/post_code_snippet_work.ipynb" data-href="https://github.com/yvan/nbsblogs/blob/master/generating_monters/post_code_snippet_work.ipynb" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">You can see the full notebook code for this blog post here</a>.</p><p name="fe40" id="fe40" class="graf graf--p graf-after--p">In this post we walked through how to use a GAN to generate monsters. You can use them in your games/game prototypes. You can use them as a starting point for more developed artwork. You can use them just to get ideas. GANs are a really great cerative tool and a lot of fun. One warning though: it is possible to spend a week messing with it and have it not work, stick to the numbers here and you should be ok.</p><p name="9faf" id="9faf" class="graf graf--p graf-after--p">Room for improvement:</p><ul class="postList"><li name="bf04" id="bf04" class="graf graf--li graf-after--p">removing colored backgrounds from the inputs that have those would probably improve our generator, black backgrounds were kind of…awful.</li><li name="b4d6" id="b4d6" class="graf graf--li graf-after--li">more experimentation with leaky relu activations in the generator</li><li name="2766" id="2766" class="graf graf--li graf-after--li">trying a wasserstein gan loss function</li></ul><p name="38f9" id="38f9" class="graf graf--p graf-after--li">As promised below is an animation that illustrates the process of training of the generator each frame is a snapshot of its progress as it goes from grainy to crisp and detailed:</p><figure name="5415" id="5415" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 530px; max-height: 530px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*byd8KFPL-OpfU8SX45osvg.gif" data-width="530" data-height="530" src="img/1_byd8KFPL-OpfU8SX45osvg.gif"></div></figure><h4 name="9c25" id="9c25" class="graf graf--h4 graf-after--figure graf--trailing"><a href="https://tinyletter.com/generationmachine" data-href="https://tinyletter.com/generationmachine" class="markup--anchor markup--h4-anchor" rel="noopener" target="_blank">Signup for my newsletter. It’s about machine learning for video games. There will be more blogs in the future about generating content for games.</a></h4></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@yvanscher" class="p-author h-card">Yvan Scher</a> on <a href="https://medium.com/p/c1a3ece2f0a0"><time class="dt-published" datetime="2017-12-04T05:28:17.448Z">December 4, 2017</time></a>.</p><p><a href="https://medium.com/@yvanscher/using-gans-to-create-monsters-for-your-game-c1a3ece2f0a0" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on June 23, 2020.</p></footer></article></body></html>
