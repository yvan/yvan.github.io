<!DOCTYPE html><html><head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-175038637-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'UA-175038637-1');
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Playing with Perlin Noise: Generating Realistic Archipelagos</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Playing with Perlin Noise: Generating Realistic Archipelagos</h1>
</header>
<section data-field="subtitle" class="p-summary">
I haven’t seen a ton of great examples of making maps with perlin noise in python. So here we go!
</section>
<section data-field="body" class="e-content">
<section name="fbed" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="23c7" id="23c7" class="graf graf--h3 graf--leading graf--title">Playing with Perlin Noise: Generating Realistic Archipelagos</h3><p name="7862" id="7862" class="graf graf--p graf-after--h3">I haven’t seen a ton of great examples of making maps with perlin noise in python. So here we go!</p><p name="7842" id="7842" class="graf graf--p graf-after--p">Perlin noise is a mathematical formula used to generate ‘realistic’ structures. It’s noise but unlike regular noise it has some coherent structure. Here is regular noise vs. Perlin noise:</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="7b3d" id="7b3d" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*H6lwuHlprj1GYqRmav_Y2A.png" data-width="300" data-height="300" src="img/1_H6lwuHlprj1GYqRmav_Y2A.png"></div></figure><figure name="150b" id="150b" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*vs239SecVBaB4HvLsZ8O5Q.png" data-width="2048" data-height="2048" src="img/1_vs239SecVBaB4HvLsZ8O5Q.png"></div><figcaption class="imageCaption" style="width: 200%; left: -100%;">regular static and perlin noise</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="3e25" id="3e25" class="graf graf--p graf-after--figure">In the python <a href="https://pypi.org/project/noise/" data-href="https://pypi.org/project/noise/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">noise</a> module there are a few parameters that affect what you see when you generate your perlin noise:</p><ol class="postList"><li name="ebc5" id="ebc5" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">scale</strong>: number that determines at what distance to view the noisemap.</li><li name="0773" id="0773" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">octaves</strong>: the number of levels of detail you want you perlin noise to have.</li><li name="ee71" id="ee71" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">lacunarity</strong>: number that determines how much detail is added or removed at each octave (adjusts frequency).</li><li name="626d" id="626d" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">persistence</strong>: number that determines how much each octave contributes to the overall shape (adjusts amplitude).</li></ol><p name="3fb9" id="3fb9" class="graf graf--p graf-after--li">We won’t worry about scale too much, you can use it to zoom out (bigger scale) or in (smaller scale).</p><p name="0c45" id="0c45" class="graf graf--p graf-after--p">Perlin noise combines multiple functions called ‘octaves’ to produce natural looking surfaces. Each octave adds a layer of detail to the surface. For example: octave 1 could be mountains, octave 2 could be boulders, octave 3 could be the rocks.</p><p name="e886" id="e886" class="graf graf--p graf-after--p">Lacunarity of more than 1 means that each octave will increase it’s level of fine grained detail (increased frqeuency). Lacunarity of 1 means that each octave will have the sam level of detail. Lacunarity of less than one means that each octave will get smoother. The last two are usually undesirable so a lacunarity of 2 works quite well.</p><p name="7322" id="7322" class="graf graf--p graf-after--p">Persistence determines how much each octave contributes to the overall structure of the noise map. If your persistence is 1 all octaves contribute equally. If you persistence is more than 1 sucessive octaves contribute more and you get something closer to regular noise (spoiler the regular noise image above is actually a perlin noise with a presistence of 5.0). A more default setting would be a presistance of less than 1.0 which will decrease the effect of later octaves.</p><p name="0a69" id="0a69" class="graf graf--p graf-after--p">Enough chatting though! Let’s run some experiments. First let’s start with default perlin noise, and its accompanying image:</p><figure name="b39b" id="b39b" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/fbc8c513965d28b920767a46b881dd1d.js"></script></figure><figure name="368f" id="368f" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*-vO6vIHeE67CAm6Mk3AcSA.png" data-width="2046" data-height="2046" src="img/1_-vO6vIHeE67CAm6Mk3AcSA.png"></div></figure><p name="f368" id="f368" class="graf graf--p graf-after--figure">The way this perlin noise looks in our script is a 2D array of values between -1 and 1. The values that are darker on the map are lower values, the values that are close to 1 are lighter. What I want to try next is assigning two colors to different ranges of values in this map to produce some terrain:</p><figure name="59ca" id="59ca" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/c73ce9a819f68040928462824bc4531f.js"></script></figure><figure name="e277" id="e277" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 701px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100.1%;"></div><img class="graf-image" data-image-id="1*9SzECFR0cP0Eq3dYb575yA.png" data-width="2046" data-height="2048" src="img/1_9SzECFR0cP0Eq3dYb575yA.png"></div></figure><p name="a25c" id="a25c" class="graf graf--p graf-after--figure">This terrain map is pretty neat; it has jagged coasts, beaches, and lots of water. while I have never observed natural terrain that looks like this if we look at any one part of the map it seems ‘realistic.’ Let’s take it a step further and add mountains and snow:</p><figure name="507e" id="507e" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/9f1854361d6e2b5948c053b355949113.js"></script></figure><figure name="2c0e" id="2c0e" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*1GB_CsVU83Byj6NhmeaSYg.png" data-width="2050" data-height="2050" src="img/1_1GB_CsVU83Byj6NhmeaSYg.png"></div></figure><p name="517e" id="517e" class="graf graf--p graf-after--figure">This is cool but this terrain pattern is clearly not natural. To make it more natural we will use a circular filter to get rid of all the preipheral perlin noise:</p><figure name="7a11" id="7a11" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/01f56b3319f4c3eb12a07a62c8277e9a.js"></script></figure><figure name="de2d" id="de2d" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 699px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 99.8%;"></div><img class="graf-image" data-image-id="1*L2zrrXQ9iTCB6crgjPLhlA.png" data-width="2048" data-height="2044" src="img/1_L2zrrXQ9iTCB6crgjPLhlA.png"></div><figcaption class="imageCaption">We’ll call it Perlin’s World!</figcaption></figure><p name="45f4" id="45f4" class="graf graf--p graf-after--figure">Here I was trying to create an island so I made a circular filter and then applied it to the color_world perlin noise array. What I ended up was a planet floating in an ocean. I changed the ocean color to black and it looks pretty cool! That said what I wanted was an island so let’s try again. This time we’re going to calculate a circular gradient and then apply that over the perlin noise as a filter.</p><p name="280e" id="280e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Circular Gradient:</strong></p><figure name="8903" id="8903" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/eafa24f258ec519e84eb837bdad6cde5.js"></script></figure><figure name="e720" id="e720" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*9OtCnEW-98wtGKWSZbvYEw.png" data-width="2042" data-height="2042" src="img/1_9OtCnEW-98wtGKWSZbvYEw.png"></div></figure><p name="e685" id="e685" class="graf graf--p graf-after--figure">I struggled a lot with this part. I’m sure there is a more efficient way to get the gradient like this but the above was what I came up with. I calculated a distance metric from the center of the map and then normalized, shrunk, and renomalized those distances to produce this spherical gradient. Again lighter means the value is closer to 1, darker colors are closer to 0. Next I apply this circular gradient to the perlin noise we created before.</p><p name="7d53" id="7d53" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Circular Gradient + Noise:</strong></p><figure name="36f1" id="36f1" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/373057728d000886e8eca3dbd350ba84.js"></script></figure><figure name="61dd" id="61dd" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*va8FErR92Fl8qxW8iW5TSw.png" data-width="2038" data-height="2038" src="img/1_va8FErR92Fl8qxW8iW5TSw.png"></div></figure><p name="a15a" id="a15a" class="graf graf--p graf-after--figure">This part was less tricky but still a pain. I multiply the perlin noise by the circle gradient and then I increase the contrast by multiplying positive (lighter values) by 20. Then I renormalize to make it 0–1 again.</p><p name="6f66" id="6f66" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Colorized</em> Circular Gradient + Noise:</strong></p><figure name="b356" id="b356" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/yvan/d4ffb92d520f93adfd1d548747cdf0ac.js"></script></figure><figure name="af36" id="af36" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 703px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100.4%;"></div><img class="graf-image" data-image-id="1*HdJFvpnq99uBkHXnzuCbBg.png" data-width="2036" data-height="2044" src="img/1_HdJFvpnq99uBkHXnzuCbBg.png"></div></figure><p name="da0f" id="da0f" class="graf graf--p graf-after--figure">This is really cool and it looks like a much more natural archipelago. I encourage you to try different shading methods and maybe randomly removing some sections. I’m going to change the threshold value and set it as <code class="markup--code markup--p-code">threshold = 0.2</code>. That will produce a smaller but more realistic archipelago as so:</p><figure name="48de" id="48de" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 699px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 99.9%;"></div><img class="graf-image" data-image-id="1*-rGEq0CVz2FgA2fScqDRiA.png" data-width="2046" data-height="2044" src="img/1_-rGEq0CVz2FgA2fScqDRiA.png"></div></figure><p name="5148" id="5148" class="graf graf--p graf-after--figure">There we are! We have a natural looking island archipelago! So now that we have our islands you may notice that no matter how often you rerun this script perlin noise will produce the same islands. To get new islands you can set the <code class="markup--code markup--p-code">base</code> parameter of the pnoise2 function to a random integer number, let’s try <code class="markup--code markup--p-code">base=5, base=100</code>:</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="bf89" id="bf89" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.025%;"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 99.9%;"></div><img class="graf-image" data-image-id="1*Dz3pQvrQVss-mEx2Ct1keA.png" data-width="2044" data-height="2042" src="img/1_Dz3pQvrQVss-mEx2Ct1keA.png"></div></figure><figure name="9820" id="9820" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.975%;"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*cuG36nNZInnC49zGx5Kqrw.png" data-width="2040" data-height="2040" data-is-featured="true" src="img/1_cuG36nNZInnC49zGx5Kqrw.png"></div><figcaption class="imageCaption" style="width: 200.1%; left: -100.1%;">Archipelagos generated from base 5 and base 100.</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><h4 name="a7dc" id="a7dc" class="graf graf--h4 graf-after--figure">Conclusion</h4><p name="b286" id="b286" class="graf graf--p graf-after--h4">So we started with some simple noise and ended up with a way to generate a realtively unlimited number of unique and natural looking archipelagos! I hope you enjoyed this post!</p><p name="c035" id="c035" class="graf graf--p graf-after--p"><a href="https://nbviewer.jupyter.org/github/yvan/nbsblogs/blob/master/playing_with_perlin_noise/generate_islands.ipynb" data-href="https://nbviewer.jupyter.org/github/yvan/nbsblogs/blob/master/playing_with_perlin_noise/generate_islands.ipynb" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">The full notebook with all code is here.</a></p><h4 name="f738" id="f738" class="graf graf--h4 graf-after--p graf--trailing"><a href="https://tinyletter.com/generationmachine" data-href="https://tinyletter.com/generationmachine" class="markup--anchor markup--h4-anchor" rel="noopener" target="_blank">If you enjoyed this post you can sign up for my newletter here and stay up to date on cool and interesting projects.</a></h4></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@yvanscher" class="p-author h-card">Yvan Scher</a> on <a href="https://medium.com/p/b59f004d8401"><time class="dt-published" datetime="2017-11-07T03:09:36.624Z">November 7, 2017</time></a>.</p><p><a href="https://medium.com/@yvanscher/playing-with-perlin-noise-generating-realistic-archipelagos-b59f004d8401" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on June 23, 2020.</p></footer></article></body></html>
